<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Document</title>
        <style>
            * {
                margin:0px;
                padding:0px;
                box-sizing: border-box;
            }
    
            body, input, select, button, textarea {
                font-size: 14px;
                font-family: 'Microsoft YaHei',Tahoma, Geneva, sans-serif;
            }
            
            button {
                border-width: 0px;
                outline: none;
            }            
            
            body, html {
                width:100%;
                height:100%;
            }  

            .leftContent {
                width:50%;
                height:100%;

                display: inline-block;
            }   

            .rightContent  {
                width:50%; 
                height:100%;
                display: inline-block;            
            } 

            .container{
                width:100%;
                height:100%;
                font-size: 0px;
                background: #ADC0B4;
            }              
        </style>
    </head>
    <body>
      <div class="container">
        
      </div>
    </body>

    <script src="../lib/requirejs/require.js" type="text/javascript"></script>
    <script src="../js/common/requireconfig.js" type="text/javascript"></script>
    <script src="../js/common/xmlHttpRequestRemould.js" type="text/javascript"></script>
    <script type="text/javascript">
    require.config({
        paths: {
            "othertestmodule": '../js/fileandajax/othertestmodule',
            "filemodule": "../js/fileandajax/filemodule",
            "peity": '../lib/peity-master/jquery.peity',
            "schememodule": '../js/module/schememodule',
        },
        shim: {
            "peity": {
                deps: ["jquery"],
                exports: "peity"
            }
        }
    })

    require(["common", "othertestmodule", "filemodule", "constant", "schememodule","ajax", "jquery", "underscore"], function(common, othertestmodule, filemodule, constant, schememodule, ajax) {

        // $.ajax({
        //     url: "http://" + document.domain  + ":8088/delayloadtest",
        //     type: 'post',
        //     async : true,
        //     datatype: "json",
        //     contentType:"application/json",
        //     data:JSON.stringify({para0:1000})
        // }).then(function(data){
        //     console.log("ajax " + data);
        // }, function(data){
        //     console.log(data);
        // }) 

        // var option = {
        //     url:"http://" + document.domain  + ":8088/delayloadtest",
        //     data:{para0:1000},
        //     success:function(result) {
        //         console.log("self ajax " + result);
        //     }
        // }   

        // ajax.generalAjax(option);
        // 
        
        var oldThen = Promise.prototype.then;

        function action() {
            console.log("thnis is apply before then");
        }

        function newThen() {
            action();
            return oldThen.apply(this, arguments);
        }

        Promise.prototype.then = newThen;

        fetch("http://" + document.domain  + ":8088/delayloadtest?para0=1000", { method: 'get' })
        .then(function(response) {
            console.log("this is response");
            return response.text()
         })
        .then(function(result) {
            console.log("this is result");
            console.log(result);
        })
        .catch(function(err) {
            console.log(err);
         });

    })
    </script>
</html>